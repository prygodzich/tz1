# Тестовое задание

## Описание задачи

Необходимо написать MVP версию сервиса на Golang, который отдает статический контент. 

Всего два endpoint`а: 
1. Отдача JS контента
2. Отдача видео файла

Общая архитектура

Весь конетнт храниться в S3 хранилище, но сначала проверяется есть ли запрашиваемый контент в кеше, если есть то отдается из кеша, если нет, то берется из S3 и записывается в кеш.  

Также, для оптимизации похода в во внешний кеш и минимизации сетевой задержки, нужно реализовать локальный кеш, который очищается раз в 10 минут. 

Важно за 100мс ответ должен быть дан в любом случае. Если контент мы не получили, то отправляется дефолтные файлы. 

Должно быть логирование, разбито на прод и локал и должен быть минимальный сбор метрик прометеуса. 

*Задача со звездочкой, не обязательна к исполнению: 

при отдаче js контента, реализовать механику тестов, чтобы на выбранный процент или на конкретный домен отдавался контент из бакета test в s3.


## Пример тестовой API

|Method|URL|Descrition|
|:--|:--|:--|
|GET|/js?name=name_file.js| Получить js файл|
|GET|/video?name=name_file.mp4| Получить видео файл|
|GET|/metrics| метрики prometheus|

## Структура проекта

```sh
├── cmd -- точки входа в приложение
├── internal
│   ├── apperrs -- основные типы ошибки приложения
│   │   └── errors.go
│   ├── application -- сборка компонентов приложения / ручной DI
│   ├── config -- сборка конфигурации по переменным окружения
│   ├── http -- 
│   │   └── handler -- обработчики входящих запросов
│   │   └── server -- http-сервер
│   ├── logger -- логирование
│   ├── metrics -- метрики prometheus
│   └── storage
│       └── aws -- aws-s3 хранилище
│       └── local -- локальное хранилище
│       └── redis -- быстрое хранилище на базе redis
├── scripts -- вспомогательные скрипты

```

## Запуск приложения

Используемые переменные окружения представлены в файле .env.example, который лежит в корне проекта.
Проект использует файл .env для определения переменных окружения.

Посмотреть варианты запуска можено использовав команду `make`

Для первого запуска можно использовать команду:

```sh
docker-compose up -d
# дождаться завершения
make run

```



## Разработка проекта

Для разработки могут понадобиться дополнитльные инструменты. Их можно установить через:
```sh
# инструменты будут скачены в папку ./tools/bin
make install-tools
```

Запуск тестов

```sh
make test
```

Проверить покрытие тестами

```sh
make test-coverage
```



